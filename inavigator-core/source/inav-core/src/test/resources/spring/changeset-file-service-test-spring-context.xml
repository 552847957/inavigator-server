<?xml version="1.0" encoding="UTF-8"?>
<beans profile="unit-test"
       xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="http://www.springframework.org/schema/beans
                           http://www.springframework.org/schema/beans/spring-beans.xsd">

    <import resource="cache-diff-checker-service-test-spring-context.xml"/>

    <bean name="changesetFileServiceTestBean" class="ru.sberbank.syncserver2.service.file.FileService">
        <property name="fileCache" ref="spyChangesetFileCacheTestBean"/>
    </bean>
    <bean name="spyChangesetFileServiceTestBean" class="org.mockito.Mockito" factory-method="spy">
        <constructor-arg name="object" ref="changesetFileServiceTestBean"/>
    </bean>

    <bean name="changesetFileCacheTestBean" class="ru.sberbank.syncserver2.service.file.cache.FileCache">
        <!-- addLoader(spySpyMbrUnzipperTestBean) ???????   How to do this ?????? -->
    </bean>
    <bean name="spyChangesetFileCacheTestBean" class="org.mockito.Mockito" factory-method="spy">
        <constructor-arg name="object" ref="changesetFileCacheTestBean"/>
    </bean>

    <bean name="mbrUnzipperTestBean" class="ru.sberbank.syncserver2.service.file.cache.zip.MbrUnzipper">
        <property name="archiveFolder" value="test/tmp/directory/ChangesetFileServiceTest/archiveFolder"/>
        <property name="cacheFolder" value="test/tmp/directory/ChangesetFileServiceTest/cacheFolder"/>
        <property name="inboxFolder" value="test/tmp/directory/ChangesetFileServiceTest/inboxFolder"/>
        <property name="chunkSize" value="1024"/>
        <!--<property name="chunkSize" value="262144"/>-->
        <property name="tempFolder" value="test/tmp/directory/ChangesetFileServiceTest/tempFolder"/>
    </bean>
    <bean name="spyMbrUnzipperTestBean" class="org.mockito.Mockito" factory-method="spy">
        <constructor-arg name="object" ref="mbrUnzipperTestBean"/>
    </bean>

    <bean name="dynamicFileListerTestBean" class="ru.sberbank.syncserver2.service.file.cache.list.DynamicFileLister">
        <property name="statusFile" value="tmp/directory/ChangesetFileServiceTest/changeset/actualFileInfos.obj"/>
    </bean>
    <bean name="spyDynamicFileListerTestBean" class="org.mockito.Mockito" factory-method="spy">
        <constructor-arg name="object" ref="dynamicFileListerTestBean"/>
    </bean>

    <bean name="tempFolderChangeSetComposer" class="java.io.File">
        <constructor-arg value="test/tmp/directory/ChangesetFileServiceTest/mbrList"/>
    </bean>
    <bean name="changeSetComposer" class="ru.sberbank.syncserver2.service.generator.rubricator.ChangeSetComposer">
        <constructor-arg name="tempFolder" ref="tempFolderChangeSetComposer"/>
    </bean>
    <bean name="spyChangeSetComposer" class="org.mockito.Mockito" factory-method="spy">
        <constructor-arg name="object" ref="changeSetComposer"/>
    </bean>

    <bean name="dataPowerNotificationLogger" class="ru.sberbank.syncserver2.service.monitor.DataPowerNotificationLogger">
        <property name="dataPowerBeanCode" value="spyDataPowerServiceTestBean"/>
    </bean>
    <bean name="spyDataPowerNotificationLogger" class="org.mockito.Mockito" factory-method="spy">
        <constructor-arg name="object" ref="dataPowerNotificationLogger"/>
    </bean>

</beans>